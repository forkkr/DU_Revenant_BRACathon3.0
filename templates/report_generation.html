{% extends "page_layout.html" %}

{% block body %}
<div class="container-fluid " >

<form id="form" action="/report-generation-done/{{ report_id }}" method="POST">

    <div class="container-fluid p-lg-4 bg-info">

        <div class="input-group input-group-lg">
          <div class="input-group-prepend">
            <span class="input-group-text">Report Name</span>
          </div>
          <input  name = "reportName" id="reportName" type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-lg">
        </div>
    </div>

    <div class="row p-lg-4 bg-light">
        <div class="col-md-3 order-md-1 mb-4">
          <h5 class="d-flex justify-content-between align-items-center mb-2">
            <span class="text-muted">Add Prev Questions</span>
          </h5>
          <ul class="list-group mb-2">
            <li type="button" class="list-group-item d-flex justify-content-between lh-condensed">
              <div>
                <h6 class="my-0">Question 1</h6>
                <small class="text-muted">Type: Number</small>
              </div>

            </li>
            <li class="list-group-item d-flex justify-content-between lh-condensed">
              <div>
                <h6 class="my-0">Question 2</h6>
                <small class="text-muted">Brief description</small>
              </div>

            </li>
            <li class="list-group-item d-flex justify-content-between lh-condensed">
              <div>
                <h6 class="my-0">Question 3</h6>
                <small class="text-muted">Brief description</small>
              </div>

            </li>
            <li class="list-group-item d-flex justify-content-between lh-condensed">
              <div>
                <h6 class="my-0">Question 4</h6>
                <small class="text-muted">Brief description</small>
              </div>

            </li>

          </ul>


        </div>


        <div id = "questions" class="col-md-9 order-md-2" >

            <div class="row">
                <div class="mb-3">
                    <button  id="btn" name="btn" type="button" class="btn btn-info ">Add New Question</button>
                </div>
                <div class="mb-3">
                    <button  id="submitButton" name="submitButton"class="btn btn-success ">Submit</button>
                </div>
            </div>
            <div id = "card_1" class="card-body bg-white" >
                <div id="group1" class="form-row">
                    <div class="form-group col-md-7">
                      <label for="q_1">Question </label>
                      <input type="text" class="form-control border-primary " id="q_1" name="q_1">
                        <div id="choice_option_1" class="p-3 ">



                        </div>
                    </div>
                    <div class="form-group col-md-2">
                      <label for="qtype_1" >Answer type</label>
                      <select id="qtype_1" name="qtype_1" onchange="add_choice(this.value,1)" class="form-control border-primary">
                        <option selected>Number</option>
                        <option>Text</option>
                        <option value="mc">Multiple Choice</option>
                        <option value="cb">Check box</option>
                        <option>Short Answer</option>
                        <option>Percentage</option>
                        <option>File Upload</option>
                      </select>
                    </div>

                    <div class="form-group col-md-2">
                      <label for="atype_1" >Analysis type</label>
                      <select id="atype_1" name="atype_1" class="form-control border-primary">
                        <option selected>Graph</option>
                        <option>Bar-Chart</option>
                        <option>Pie-Chart</option>
                      </select>
                    </div>
                    <div  class="form-group col-md-1" >
                        <label style="color: white" > m</label>
                      <button onclick="removeElement(id)" id="_1" name="_1" type="button" class="btn btn-outline-danger">Remove</button>
                    </div>
                </div>


            </div>
        </div>


    </div>

</form>

    <script>

        var count=1;
        $("#btn").click(function(){

          $("#questions").append(addNewRow());
          count++;
        });

        function addNewRow(){
            var idd = "group"+count;
            var newrow= '<div id = "card_' + count +'" class="card-body bg-white" >\n' +
                '                <div id="group_' + count +'" class="form-row">\n' +
                '                    <div class="form-group col-md-7">\n' +
                '                      <label for="q_' + count +'">Question </label>\n' +
                '                      <input type="text" class="form-control border-primary " id="q_' + count +'" name="q_' + count +'">\n' +
                '                        <div id="choice_option_' + count +'" class="p-3 ">\n' +
                '\n' +
                '                        </div>\n' +
                '                    </div>\n' +
                '                    <div class="form-group col-md-2">\n' +
                '                      <label for="qtype_' + count +'" >Answer type</label>\n' +
                '                      <select id="qtype_' + count +'" name="qtype_' + count +'" onchange="add_choice(this.value,'+count+')" class="form-control border-primary">\n' +
                '                        <option selected>Number</option>\n' +
                '                        <option>Text</option>\n' +
                '                        <option value="mc">Multiple Choice</option>\n' +
                '                        <option value="cb">Check box</option>\n' +
                '                        <option>Short Answer</option>\n' +
                '                        <option>Percentage</option>\n' +
                '                        <option>File Upload</option>\n' +
                '                      </select>\n' +
                '                    </div>\n' +
                '\n' +
                '                    <div class="form-group col-md-2">\n' +
                '                      <label for="atype_' + count +'" >Analysis type</label>\n' +
                '                      <select id="atype_' + count +'" name="atype_' + count +'" class="form-control border-primary">\n' +
                '                        <option selected>Graph</option>\n' +
                '                        <option>Bar-Chart</option>\n' +
                '                        <option>Pie-Chart</option>\n' +
                '                      </select>\n' +
                '                    </div>\n' +
                '                    <div  class="form-group col-md-1" >\n' +
                '                        <label style="color: white" > m</label>\n' +
                '                      <button onclick="removeElement(id)" id="_' + count +'" name="_' + count +'" type="button" class="btn btn-outline-danger">Remove</button>\n' +
                '                    </div>\n' +
                '                </div>\n' +
                '\n' +
                '\n' +
                '            </div>';
          return newrow;
        }

        function add_choice(value, num){
            console.log(value)
            if (value !="mc" && value != "cb"){
                document.getElementById("choice_option_"+num).innerHTML = "";
                return;
            }
            document.getElementById("choice_option_"+num).innerHTML = "";
            var card_html = document.getElementById("choice_option_"+num);
            var objNewDiv = document.createElement('div');
            objNewDiv.setAttribute('id', 'add_div');
            objNewDiv.innerHTML = '<input type="button" onclick="add_choice_option('+num+')" id="add" name="add"class="btn btn-a" value="Add Option">'
                                    + '<input type="button" onclick="remove_choice_option('+num+')" id="remove" name="remove"class="btn btn-a" value="Remove Option">';
            var new_html = '  ';

            card_html.appendChild(objNewDiv);
        }

        function removeElement(id) {
            var cardID = "card"+id;
            var element = document.getElementById(cardID);
            element.parentNode.removeChild(element);

        }


        //Counter to maintain number of Optiones and give them unique id for later reference
        var intOption = 0;

        /**
        * Function to add Option element dynamically
        * First we incrementing the counter and creating new div element with unique id
        * Then adding new Option element to this div and finally appending this div to main content.
        */
        function add_choice_option(num) {
            intOption++;
            var objNewDiv = document.createElement('div');
            objNewDiv.setAttribute('id', 'div_' + intOption);
            objNewDiv.setAttribute('class', 'p-2' );
            objNewDiv.innerHTML = 'Option : <input type="text" id="tb_' + intOption + '" name="tb_' + intOption + '"/>';
            document.getElementById('choice_option_'+num).appendChild(objNewDiv);
        }

        /**
        * Function to remove Option element dynamically
        * check if counter is more than zero then remove the div element with the counter id and reduce the counter
        * if counter is zero then show alert as no existing Optiones are there
        */
        function remove_choice_option(num) {
            if(0 < intOption) {
                document.getElementById('choice_option_'+num).removeChild(document.getElementById('div_' + intOption));
                intOption--;
            } else {
                alert("No Option to remove");
            }
        }



    </script>



 </div>
{% endblock %}